### `tasks.txt` â€“ Backend Task List â€“ RACE Resume Enhancer

  Format: Append "âœ…" to a task once it is successfully completed and verified.

ğŸ’¡ Structure: Layer â†’ Sub-layer â†’ Task ID â†’ Task â†’ [Priority]

â¸»

1. ğŸ§± Setup & Basic Server

1.1 Initialize backend  
â€ƒâ€¢ 1.1.1 `npm init -y` and create folders: routes, controllers, models, middleware, utils âœ…

1.2 Install dependencies  
â€ƒâ€¢ 1.2.1 Install express, mongoose, cors, dotenv, multer, jsonwebtoken, latex.js, @google/generative-ai (Gemini 2.0 Flash SDK) âœ…

1.3 Create base server files  
â€ƒâ€¢ 1.3.1 `app.js` to set up middleware and routes âœ…  
â€ƒâ€¢ 1.3.2 `index.js` to start the server âœ…  
â€ƒâ€¢ 1.3.3 Use express.json(), cors(), and file upload middleware âœ…

1.4 Setup .env  
â€ƒâ€¢ 1.4.1 Define PORT, MONGO_URI, JWT_SECRET, GEMINI_API_KEY âœ…

â¸»

2. ğŸ“„ Resume Upload & Extraction

2.1 File upload (routes/resume.js)  
â€ƒâ€¢ 2.1.1 Setup multer for uploading `.pdf` or `.docx` files âœ…  
â€ƒâ€¢ 2.1.2 POST /upload â†’ handle file upload âœ…  
â€ƒâ€¢ 2.1.3 Add error handling for file size/type validation (500 MB max, .pdf, .docx only) âœ…

2.2 Resume extraction logic (utils/extract.js)  
â€ƒâ€¢ 2.2.1 Convert PDF/DOCX to plain text âœ…  
â€ƒâ€¢ 2.2.2 Extract structured resume info (name, skills, education, etc.) âœ…  
â€ƒâ€¢ 2.2.3 Add error handling for failed file extraction (e.g., file corruption, parsing issues) âœ…

2.3 Save original resume (models/Resume.js)  
â€ƒâ€¢ 2.3.1 Schema: userId, originalText, createdAt âœ…  
â€ƒâ€¢ 2.3.2 Save extracted data as version `v0` âœ…  
â€ƒâ€¢ 2.3.3 Handle database errors on saving original resume âœ…

â¸»

3. âœ¨ Resume Enhancement (Gemini 2.0 Flash)

3.1 Gemini 2.0 Flash integration (utils/gemini.js)  
â€ƒâ€¢ 3.1.1 Setup Gemini 2.0 Flash SDK with key âœ…  
â€ƒâ€¢ 3.1.2 createEnhancement(text) â†’ returns improved resume content âœ…  
â€ƒâ€¢ 3.1.3 Format response in LaTeX âœ…  
â€ƒâ€¢ 3.1.4 Add error handling for Gemini API errors (invalid API key, request limit) âœ…

3.2 Enhancement endpoint  
â€ƒâ€¢ 3.2.1 POST /enhance â†’ takes existing resume and sends to Gemini 2.0 Flash âœ…  
â€ƒâ€¢ 3.2.2 Return LaTeX-enhanced output âœ…  
â€ƒâ€¢ 3.2.3 Store enhanced version only when user clicks "Save" âœ…  
â€ƒâ€¢ 3.2.4 Add error handling for missing resume data or invalid inputs âœ…

3.3 Enhanced Resume model  
â€ƒâ€¢ 3.3.1 Schema: resumeId, version, latexText, createdAt âœ…  
â€ƒâ€¢ 3.3.2 Handle errors when saving enhanced versions in DB âœ…

â¸»

4. ğŸ’¬ Chatbot Integration (RACE Bot)

4.1 Chat model (models/Chat.js)  
â€ƒâ€¢ 4.1.1 Schema: userId, resumeId, messages[], timestamps âœ…

4.2 Chat route  
â€ƒâ€¢ 4.2.1 POST /chat â†’ send user msg + prev messages to Gemini 2.0 Flash âœ…  
â€ƒâ€¢ 4.2.2 Get contextual reply and append to DB âœ…  
â€ƒâ€¢ 4.2.3 GET /chat/:resumeId â†’ return chat history for specific resume âœ…  
â€ƒâ€¢ 4.2.4 Add error handling for missing messages, invalid tokens, or DB issues âœ…

4.3 Gemini chat function  
â€ƒâ€¢ 4.3.1 Format messages[] into Gemini-compatible input âœ…  
â€ƒâ€¢ 4.3.2 Return updated conversation history âœ…  
â€ƒâ€¢ 4.3.3 Add error handling for Gemini API errors (e.g., rate limiting, bad input) âœ…

â¸»

5. ğŸ” Authentication (JWT)

5.1 User model (models/User.js)  
â€ƒâ€¢ 5.1.1 Fields: email, passwordHash âœ…

5.2 Auth routes (routes/auth.js)  
â€ƒâ€¢ 5.2.1 POST /register â†’ hash password, save user âœ…  
â€ƒâ€¢ 5.2.2 POST /login â†’ verify, return JWT âœ…  
â€ƒâ€¢ 5.2.3 Add error handling for invalid user inputs or login failure âœ…

5.3 Auth middleware (middleware/auth.js)  
â€ƒâ€¢ 5.3.1 Verify JWT for protected routes âœ…  
â€ƒâ€¢ 5.3.2 Handle errors for missing or invalid JWT âœ…

â¸»

6. ğŸ§ª Testing & Error Handling

6.1 Test endpoints  
â€ƒâ€¢ 6.1.1 /upload, /enhance, /chat, /register, /login âœ…  
â€ƒâ€¢ 6.1.2 Use Postman or Thunder Client âœ…  

6.2 Error handling  
â€ƒâ€¢ 6.2.1 Use try-catch in routes âœ…  
â€ƒâ€¢ 6.2.2 Return status codes & messages âœ…  
â€ƒâ€¢ 6.2.3 Log errors to console for debugging âœ…

6.3 Console logging  
â€ƒâ€¢ 6.3.1 Log resume upload, enhancement, Gemini response âœ…

â¸»

7. ğŸ§¼ Final Touches

7.1 Input validation (optional)  
â€ƒâ€¢ 7.1.1 Validate file type, chat inputs, etc. âœ…

7.2 Folder cleanup & formatting  
â€ƒâ€¢ 7.2.1 Use Prettier or ESLint âœ…  

7.3 Version control logic  
â€ƒâ€¢ 7.3.1 Ensure only user-clicked "Save" triggers new version storage âœ…

---

### `plan.txt` â€“ Project Plan â€“ RACE Resume Enhancer

ğŸ“ **Folder Structure**

```
race/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.js
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â”œâ”€â”€ resume.js
â”‚   â”‚   â””â”€â”€ chat.js
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ authController.js
â”‚   â”‚   â”œâ”€â”€ resumeController.js
â”‚   â”‚   â””â”€â”€ chatController.js
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ User.js
â”‚   â”‚   â”œâ”€â”€ Resume.js
â”‚   â”‚   â””â”€â”€ Chat.js
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ auth.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ gemini.js
â”‚   â”‚   â””â”€â”€ extract.js
â”œâ”€â”€ frontend/
```

â¸»

### ğŸ” **Authentication (JWT)**

- **Routes**:  
  - `/register`: Hash passwords and save the user data to DB.  
  - `/login`: Verify the password and issue a JWT.  

- **Error Handling**:  
  - Catch errors for missing fields in `/register` or `/login`.  
  - Return proper error codes (e.g., 400 for invalid inputs, 401 for invalid login).  
  - Handle invalid JWT in the middleware (401 Unauthorized).

---

### ğŸ’¬ **Backend API Routes**

| Method | Endpoint      | Description                                           |
|--------|---------------|-------------------------------------------------------|
| POST   | /upload       | Upload resume file and extract its content            |
| POST   | /enhance      | Enhance the resume with Gemini 2.0 Flash and save as LaTeX format |
| POST   | /register     | Register a new user                                  |
| POST   | /login        | Log in an existing user and issue JWT                |
| POST   | /chat         | Send a user message, get a reply from Gemini 2.0 Flash, and save |
| GET    | /chat/:resumeId | Fetch chat history for the given resume               |

---

### ğŸ§  **Models**

- **User**  
  `{ _id, email, passwordHash }`

- **Resume**  
  `{ _id, userId, originalText, createdAt }`

- **Chat**  
  `{ _id, userId, resumeId, messages: [{ role: 'user' | 'bot', msg: String }], createdAt, updatedAt }`

---

### ğŸ¤– **Gemini 2.0 Flash Integration**

- **API**:  
  - Use Gemini 2.0 Flash for resume enhancement and chat replies.  
  - Return both the enhanced resume (LaTeX) and chat history.

- **Error Handling**:  
  - Handle API errors, such as invalid API keys or rate-limiting.  
  - Log errors in `console.log()` for debugging.

---

### ğŸ§ª **Error Handling Logic**

- **Global Error Handler**  
  - Add a global error handler middleware to catch unexpected errors and return a 500 status code with a user-friendly message.  
  - Wrap all async route logic in try-catch blocks.

- **Specific Error Handlers**:  
  - File upload: Handle file size/type validation.  
  - Resume extraction: Handle errors in file parsing or empty data.  
  - Gemini: Handle API errors such as rate limiting or invalid inputs.

---

### ğŸ§¼ **Final Polish**

- **Input Validation**:  
  - Use a library `zod` to validate incoming request bodies.  
  - Check for valid email format, file types, and chat inputs.

- **Logging**:  
  - Log successful and failed requests for better debugging.  
  - Log Gemini responses to